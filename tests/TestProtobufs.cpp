#include "UnitTest++.h"
#include "protobufs.h"

struct ProtobufsFixture
{
  static const uint8_t credentials[40];
};

const uint8_t ProtobufsFixture::credentials[40] ={
  0x50, 0x8e, 0x8a, 0xfd, 0x78, 0x73, 0x23, 0x38,
  0x67, 0xd6, 0x56, 0xc0, 0xca, 0x46, 0x04, 0x8e,
  0x0a, 0xbb, 0x06, 0xe3, 0x9b, 0xc5, 0x7e, 0x2c,
  0x9b, 0xce, 0x0b, 0xdf, 0xc5, 0x52, 0xc8, 0x2d,
  0xf6, 0x48, 0x0d, 0x23, 0xc5, 0x0e, 0x2d, 0x6d };

TEST_FIXTURE(ProtobufsFixture, ExampleHelloSizeIs16Bytes)
{
  uint8_t hello[16];
  int hello_size;
  hello_from_aes_credentials(credentials, hello, hello_size);
  CHECK_EQUAL(16, hello_size);
}

TEST_FIXTURE(ProtobufsFixture, ValidHelloFromAESCredentials)
{
  uint8_t expected[16] = {
    0x58, 0x4f, 0x96, 0xfc, 0xb3, 0xdf, 0x98, 0x32,
    0xb3, 0x7c, 0x72, 0x43, 0x04, 0xc1, 0xc3, 0xfb };
  uint8_t hello[16];
  int hello_size;
  hello_from_aes_credentials(credentials, hello, hello_size);
  CHECK_ARRAY_EQUAL(expected, hello, hello_size);
}
